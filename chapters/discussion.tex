\chapter{Discussion}\label{chap:discussion}

The results obtained shows that the controller requirements and the implementation requirements were sufficiently fulfilled, despite there being minor issues. While some, such as requirement \textbf{E} were not completely fulfilled, the concept was proven.

The initial simulations indicated that the controllers performed satisfactory with regards to their respective design parameters. The LQR controller was shown to have a faster step response than the $\mathcal{H}_\infty$ controller, while the $\mathcal{H}_\infty$ controller proved to be more robust towards noise and disturbances. From this it is further emphasized that the LQR is an optimal controller while the $\mathcal{H}_\infty$ controller is described as being robust. It should be noted that the $\mathcal{H}_\infty$ design technique is known for producing a conservative controller with regards to performance.

The implementation of the controllers on the ASV was problematic. Both controllers in the real system were too aggressive and the vessel did not behave as simulated. From this it was determined that some dynamics of the system were not modeled. Even though the model was verified in \autoref{sec:modelVerification}, upon further inspection it was noticed that only a constant force was applied to the motors, thus neglecting the transients of the motors. During testing a significant delay was noticed in the response time of the motors. It should also be noted that the motors have a dead zone in the lower range of the operation area. This meant it was difficult for the motors to perform minor corrections, which degraded the performance of the controller. Due to these reasonings it was decided that the system model excluded a good description of the motors. \fxnote{should we add that the motors also behave differently with one forward and one backwards}

During testing it was also seen that vessel was sensitive to wave disturbances. Since the vessel has a narrow hull and the thrusters are placed close together, it is difficult for the vessel to reject these disturbances when it affects the $y_\mathrm{b}$ direction. This effect was visible in Klingenberg pond where the waters can be considered calm. This is concerning as the intended use is to survey Port of Aalborg, which is assumed to have larger disturbances. Once again, it should be reiterated that the simulations prove the designed controller is capable of rejecting these larger disturbances.

The ROS implementation was deemed satisfactory as it was possible to successfully simulate the controller as described in \autoref{app:ModelNode}. Unfortunately, the Kalman filter to estimate position did not work as intended and was not tested during simulation in ROS. This is due to an error within the ROS implementation but was not corrected as there was limited time left in the project. To overcome this problem, the implementation from \cite{thesis} was used. Besides this minor error, the simulated Kalman filters estimate the attitude and position of the vessel when the measurements are subjected to the noise similar to the real system.

The RTK GPS implemented shows a 95 percentile which gives a precision well below 30 cm, when it receives base correction data. The base correction data in \fxnote{ref to gps appendix, and check if makes sense} indicates there is an accuracy error. This error may be due to reflections from surrounding buildings as well as the antenna on the vessel being highly directional. While the exact position of the ASV may not be accurate, the RTK GPS shows it will consistently give precise data.

% However, the controller design proved to be an issue when testing the system in real life. 
% This indicates that there is some dynamics in the system that is not taken into account. 
% The lack of a good motor description in the system model is suspected to introduce a significant delay in the system, which could influence the dynamics of the vessel . 
% Additionally, the motors had a dead zone in the lower range of the operation area. 
% This means the motors have a hard time preforming minor corrections, as these tend to require smaller motor values, thus limiting the precision of the corrections the vessel is able to preform. 